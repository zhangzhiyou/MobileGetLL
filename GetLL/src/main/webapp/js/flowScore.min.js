function FlowScore(){this.querCreditSumPath_="/ajax/queryCreditSum.action";this.queryCreditDetailPath_="/ajax/queryCreditDetail.action?type=";this.downType_="down";this.upType_="up"}FlowScore.prototype.loadCreditSum=function(b){var a=this;$.ajax({type:"GET",url:a.querCreditSumPath_,cache:false,dataType:"json",timeout:25000,success:function(f){if(f.status!="ok"){a.showErrorResult(f);return}else{var c=f.result;var e=$("#days");if(e){e.html("流量币 | 最近"+c.days+"天 |")}var g=$("#incomeDiv");if(g){g.html(c.income)}var d=$("#expensesDiv");if(d){d.html(c.consumes)}}if(b){b(f)}},error:function(c){}})};FlowScore.prototype.loadFirstCreditDetail=function(c){var a=this;a.stop_=false;a.detailId_=0;var b=a.queryCreditDetailPath_+a.upType_+"&startNum=0";if(!a.isloading){a.isloading=true;$.ajax({type:"GET",url:b,cache:false,dataType:"json",timeout:25000,success:function(g){a.isloading=false;if(g.status!="ok"){a.showErrorResult(g,"first");return}else{var d=g.result;var f=d.list;if(f!=null&&f.length>0){var e=a.getDetailHtml(g);$("#mingxiListDiv").html(e);a.detailId_=f[f.length-1].accessId;a.stop_=false}else{a.stop_=true}}if(c){c(g)}},error:function(d){a.isloading=false}})}};FlowScore.prototype.getDetailHtml=function(g){var p=g.result;var j=p.list;var l=new Array();for(var h=0;h<j.length;h++){var f=j[h];var o="";var m="";var k=f.operImg;var n=f.operTypeId;var d=f.operResultDesc=="null"?"":f.operResultDesc;var a=f.accessType;if(a=="1"){o="myaccount_mingxi_green";m="+"}else{if(a=="2"){o="myaccount_mingxi_blue";m="-";if(n=="TIGER_GIVE"){d="投币成功"}}}if(n=="CREDIT_EXCHANGE_GIVE"){k="dh_1.png";if(f.operResult!="0"){k="dh_zs.png"}}var c="myaccount_mingxi_gray";if(f.operResult!="0"){c="myaccount_mingxi_red"}var e=f.credit;if(e=="0"||e==0){m=""}l[h]=['<div class="myaccount_mingxi_shouzhi_list">','<div class="myaccount_mingxi_shouzhi_logo"><img src="/image/'+k+'" width="60" height="60" /></div>','<div class="text_m">',"<div>"+f.operDesc+"</div>",'<div class="myaccount_mingxi_gray">'+f.accessTime+"</div>","</div>",'<div class="text_r">','<div class="'+o+'">'+m+" "+e+"</div>",'<div class="'+c+'">'+d+"</div>","</div>","</div>"].join("")}var b=l.join("");return b};FlowScore.prototype.showErrorResult=function(c,a){if(c.status!="ok"){var b=c.message;if(a=="first"){if(c.code=="EMPTY"){}else{alert(b)}}else{alert(b)}return}};FlowScore.prototype.loadNoFirstCreditDetail=function(){var a=this;var b=a.queryCreditDetailPath_+a.downType_+"&startNum="+a.detailId_+"&r="+Math.random();if(!a.stop_){if(!a.isloading){a.isloading=true;$.ajax({type:"GET",url:b,cache:false,dataType:"json",timeout:25000,success:function(f){a.isloading=false;if(f.status!="ok"){return}else{var c=f.result;var e=c.list;if(e!=null&&e.length>0){var d=a.getDetailHtml(f);$("#mingxiListDiv").append(d);a.detailId_=e[e.length-1].accessId;a.stop_=false}else{a.stop_=true}}},error:function(c){a.isloading=false}})}}};FlowScore.prototype.loadCreditDetail=function(a){var b=this;if(a=="up"){b.loadFirstCreditDetail()}else{b.loadNoFirstCreditDetail()}};FlowScore.prototype.getFlowScoreTransferGiftsInfo=function(a){$.post("/ajax/getTransferGiftsList.action?queryType=count&type=others&status=2&r="+Math.random(),{},function(c){if(c.status!="ok"){return}else{var b=c.result;if(Number(b.totalCredit)>0){$("#receiveDiv").show();$("#totalCredit").html(b.totalCredit)}}if(a){a(c)}},"json")};FlowScore.prototype.getTotalFlow=function(a){$.post("/ajax/getPackage.action?r="+Math.random(),{},function(f){if(f.status!="ok"){showErrorResult(f)}else{var o=f.result;$("#TotalFlowDiv").html(o.sumNumTotal);$("#LeftFlowDiv").html(o.leftNumTotal);$("#distanceDays").html(o.distDay);$("#dayNum").html(o.dayNum);var c=$("#totalDiv").html("");var j=$("#jiaitem_tmp_tubiao").html();var m=j.replace(/#id#/g,"").replace(/#data-total#/g,o.sumNumTotal).replace(/#data-part#/g,o.usedNumTotal).replace(/#data-text#/g,o.leftNumTotal).replace(/#fgcolor#/g,"#61a9dc").replace(/#top_desc#/g,o.usedNumTotal+"/"+o.sumNumTotal+"M").replace(/#botton_desc#/g,"计费数据有延时，仅供参考，请以月结数据为准。");c.append(m);var h=o.list;var n=new Array();n.push("#dc9e3e");n.push("#01b678");n.push("#DC7294");n.push("#DC7A5A");n.push("#B6376E");n.push("#7E3BDC");var b=$("#tmp_ll_detail");var g=[];for(var e=0;e<h.length;e++){var d=h[e];j=$("#jiaitem_tmp_tubiao").html();m=j.replace(/#id#/g,e).replace(/#data-total#/g,d.SUMNUM).replace(/#data-part#/g,d.USEDNUM).replace(/#data-text#/g,d.LEFTNUM).replace(/#top_desc#/g,d.USEDNUM+"/"+d.SUMNUM+"M").replace(/#botton_desc#/g,d.PRIVSET).replace(/#fgcolor#/g,n[e]);g.push(m)}g.sort(function(p,i){if(p.lengh!=i.length){return p.length>i.length}else{return p>i}});var l=$(".panel-title",b);var k=$(".listDiv",b);for(e=0;e<g.length;e++){m=g[e];l.html("套餐明细-"+(e+1));k.html('<div class="col-xs-12">'+m+"</div>");alert(m);$("#mainContainer").append(b.html())}for(e=0;e<h.length;e++){$("#taocan"+e).circliful()}$("#taocan").circliful()}if(a){a(f)}},"json")};function showErrorResult(b){if(b.status!="ok"){var a=b.message;if(b.code=="EMPTY"){alert(a)}else{alert(a)}return}}var flowScore=new FlowScore();